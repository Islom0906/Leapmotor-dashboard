"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[325],{68438:(e,a,t)=>{t.d(a,{Z:()=>n});var s=t(74569),r=t.n(s);r().defaults.baseURL="".concat("https://leapmotorca.uz/api"),r().interceptors.request.use((e=>{const a=(e=>{try{return localStorage.getItem(e)}catch(a){console.log("Error getting data")}})("lptoken"),t=null!==a?"Bearer ".concat(a):"";return e.headers.authorization=t,e}));const l=r(),n={async getData(e){const{data:a}=await l.get(e);return a},async getDataByID(e,a){const{data:t}=await l.get("".concat(e,"/").concat(a));return t},async postData(e,a){const{data:t}=await l.post(e,a);return t},async editData(e,a,t){const{data:s}=await l.put("".concat(e,"/").concat(t),a);return s},async deleteData(e,a){await l.delete("".concat(e,"/").concat(a))},async deleteImages(e,a){await l.delete(e,{data:a})}}},325:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Z});var s=t(72791),r=t(2409),l=t(50419),n=t(66106),i=t(30914),d=t(49389),u=t(87309),o=t(91933),c=t(68438),m=t(98986),g=t(57689),p=t(16030),h=t(77221),x=t(7993),j=t(80184);const f={nameRu:"",nameUz:"",addressRu:"",addressUz:"",workingTime:"",tel:"",lat:"",link:""},Z=()=>{const{isLoaded:e}=(0,x.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}),[a]=r.Z.useForm(),t=(0,g.s0)(),{editId:Z}=(0,p.v9)((e=>e.editData)),y=(0,p.I0)(),[b,w]=(0,s.useState)({lat:null,lng:null}),[I,k]=(0,s.useState)({lat:41.311785,lng:69.279696}),{mutate:z,data:R,isLoading:S,isSuccess:F,error:E,isError:D}=(0,o.useMutation)((e=>{let{url:a,data:t}=e;return c.Z.postData(a,t)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{l.ZP.error(e)}}),{isLoading:U,data:v,refetch:q,isSuccess:C,error:L,isError:V}=(0,o.useQuery)(["edit-map",Z],(()=>c.Z.getDataByID("/map",Z)),{enabled:!1}),{mutate:T,isLoading:P,data:B,isSuccess:M}=(0,o.useMutation)((e=>{let{url:a,data:t,id:s}=e;return c.Z.editData(a,t,s)}));(0,s.useEffect)((()=>{M&&y({type:h.Pb,payload:""}),(F||M)&&t("/map")}),[R,B]),(0,s.useEffect)((()=>{D&&l.ZP.error(E.message),V&&l.ZP.error(L.message)}),[E,L]),(0,s.useEffect)((()=>{""!==Z&&q()}),[Z]),(0,s.useEffect)((()=>{""===Z&&a.setFieldsValue(f)}),[]),(0,s.useEffect)((()=>{if(C){const e={nameRu:v.nameRu,nameUz:v.nameRu,addressRu:v.addressRu,addressUz:v.addressUz,workingTime:v.workingTime,tel:v.tel,lat:v.lat,link:v.link};w({lat:Number(v.lat),lng:Number(v.lng)}),a.setFieldsValue(e)}}),[v]);(0,s.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],a.setFieldsValue(e));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(a.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,j.jsx)("div",{children:S||U||P?(0,j.jsx)(m.QP,{}):(0,j.jsxs)(r.Z,{form:a,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:f,onFinish:e=>{const a={...e,lat:"".concat(b.lat),lng:"".concat(b.lng)};v?T({url:"/map",data:a,id:Z}):z({url:"/map",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,j.jsxs)(n.Z,{gutter:20,children:[(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u0438\u0430\u043b\u0430 Ru",name:"nameRu",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0444\u0438\u043b\u0438\u0430\u043b\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d Ru!"}],children:(0,j.jsx)(d.default,{})})}),(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"Filial nomi Uz",name:"nameUz",rules:[{required:!0,message:"Filial nomini kiritish majburiy Uz!"}],children:(0,j.jsx)(d.default,{})})})]}),(0,j.jsxs)(n.Z,{gutter:20,children:[(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"\u0410\u0434\u0440\u0435\u0441 Ru",name:"addressRu",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0430\u0434\u0440\u0435\u0441 Ru!"}],children:(0,j.jsx)(d.default,{})})}),(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"Manzil Uz",name:"addressUz",rules:[{required:!0,message:"Manzilni kiritish shart Uz!"}],children:(0,j.jsx)(d.default,{})})})]}),(0,j.jsxs)(n.Z,{gutter:20,children:[(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f",name:"workingTime",rules:[{required:!0,message:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0447\u0430\u0441\u044b \u0440\u0430\u0431\u043e\u0442\u044b"}],children:(0,j.jsx)(d.default,{})})}),(0,j.jsx)(i.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",name:"tel",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430!"}],children:(0,j.jsx)(d.default,{})})}),(0,j.jsx)(i.Z,{span:24,children:(0,j.jsx)(r.Z.Item,{label:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442",name:"link",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f c\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442!"}],children:(0,j.jsx)(d.default,{})})})]}),(0,j.jsx)(n.Z,{gutter:20,children:(0,j.jsxs)(i.Z,{span:24,children:[e&&(0,j.jsx)(x.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:I,onClick:e=>{const t={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};k(t),w(t),a.setFieldsValue({lat:t.lat})},children:(0,j.jsx)(x.jC,{position:b})}),(0,j.jsx)(r.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,j.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:C?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.faeabd89.chunk.js.map