"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[243],{68438:function(e,i,n){n.d(i,{Z:function(){return l}});var o=n(74165),r=n(15861),t=n(74569),a=n.n(t);a().defaults.baseURL="".concat("https://leapmotorca.uz/api"),a().interceptors.request.use((function(e){var i=function(e){try{return localStorage.getItem(e)}catch(i){console.log("Error getting data")}}("lptoken"),n=null!==i?"Bearer ".concat(i):"";return e.headers.authorization=n,e}));var d=a(),l={getData:function(e){return(0,r.Z)((0,o.Z)().mark((function i(){var n,r;return(0,o.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,d.get(e);case 2:return n=i.sent,r=n.data,i.abrupt("return",r);case 5:case"end":return i.stop()}}),i)})))()},getDataByID:function(e,i){return(0,r.Z)((0,o.Z)().mark((function n(){var r,t;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.get("".concat(e,"/").concat(i));case 2:return r=n.sent,t=r.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),n)})))()},postData:function(e,i){return(0,r.Z)((0,o.Z)().mark((function n(){var r,t;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.post(e,i);case 2:return r=n.sent,t=r.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),n)})))()},editData:function(e,i,n){return(0,r.Z)((0,o.Z)().mark((function r(){var t,a;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,d.put("".concat(e,"/").concat(n),i);case 2:return t=o.sent,a=t.data,o.abrupt("return",a);case 5:case"end":return o.stop()}}),r)})))()},deleteData:function(e,i){return(0,r.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.delete("".concat(e,"/").concat(i));case 2:case"end":return n.stop()}}),n)})))()},deleteImages:function(e,i){return(0,r.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("delete image",i),n.next=3,d.delete(e,{data:i});case 3:case"end":return n.stop()}}),n)})))()}}},32243:function(e,i,n){n.r(i);var o=n(74165),r=n(15861),t=n(29439),a=n(72791),d=n(2409),l=n(50419),u=n(66106),s=n(30914),c=n(93086),v=n(87309),f=n(22645),m=n(91933),p=n(68438),g=n(98986),Z=n(57689),b=n(16030),h=n(77221),j=n(80184),F={mediaLogoId:"",mediaBrandId:"",mediaVideoId:""};i.default=function(){var e=d.Z.useForm(),i=(0,t.Z)(e,1)[0],n=(0,Z.s0)(),x=(0,b.v9)((function(e){return e.editData})).editId,O=(0,b.I0)(),w=(0,a.useState)([]),I=(0,t.Z)(w,2),S=I[0],L=I[1],y=(0,a.useState)([]),E=(0,t.Z)(y,2),P=E[0],D=E[1],V=(0,a.useState)([]),_=(0,t.Z)(V,2),k=_[0],B=_[1],C=(0,a.useState)({}),U=(0,t.Z)(C,2),R=U[0],z=U[1],M=(0,a.useState)(!1),T=(0,t.Z)(M,2),q=T[0],J=T[1],G=(0,a.useState)({}),N=(0,t.Z)(G,2),A=N[0],Q=N[1],H=(0,a.useState)({}),W=(0,t.Z)(H,2),K=W[0],X=W[1],Y=(0,a.useState)({}),$=(0,t.Z)(Y,2),ee=$[0],ie=$[1],ne=(0,m.useMutation)((function(e){var i=e.url,n=e.data;return p.Z.postData(i,n)}),{onSuccess:function(){return l.ZP.success("Success")},onError:function(e){return l.ZP.error(e.message)}}),oe=ne.mutate,re=ne.data,te=ne.isLoading,ae=ne.isSuccess,de=ne.error,le=ne.isError,ue=(0,m.useMutation)((function(e){var i=e.url,n=e.formData;return p.Z.postData(i,n)}),{onError:function(e){return l.ZP.error(e.message,"Rasmning JPG,JPEG,PNG formatlariga ruxsat etilgan")}}),se=ue.mutate,ce=ue.data,ve=ue.isLoading,fe=ue.isSuccess,me=(0,m.useQuery)(["edit-banner",x],(function(){return p.Z.getData("/banner")}),{enabled:!1}),pe=me.isLoading,ge=me.data,Ze=me.refetch,be=me.isSuccess,he=(0,m.useMutation)((function(e){var i=e.url,n=e.data,o=e.id;return p.Z.editData(i,n,o)}),{onError:function(e){return l.ZP.error(e.message)}}),je=he.mutate,Fe=he.isLoading,xe=he.data,Oe=he.isSuccess,we=he.error,Ie=he.isError,Se=(0,m.useMutation)((function(e){var i=e.url,n=e.ids;return p.Z.deleteImages(i,n)}),{onSuccess:function(){return l.ZP.success("Success")},onError:function(e){return l.ZP.error(e.message)}}).mutate;(0,a.useEffect)((function(){var e=[];(Oe&&O({type:h.Pb,payload:""}),be&&null!==A&&void 0!==A&&A.uid&&e.push(null===A||void 0===A?void 0:A.uid),be&&null!==K&&void 0!==K&&K.uid&&e.push(null===K||void 0===K?void 0:K.uid),be&&null!==ee&&void 0!==ee&&ee.uid&&e.push(null===ee||void 0===ee?void 0:ee.uid),be&&(null!==A&&void 0!==A&&A.uid||null!==K&&void 0!==K&&K.uid||null!==ee&&void 0!==ee&&ee.uid))&&Se({url:"/medias",ids:{ids:e}});(ae||Oe)&&n("/banner")}),[re,xe]),(0,a.useEffect)((function(){le&&l.ZP.error(de.message),Ie&&l.ZP.error(we.message)}),[de,we]),(0,a.useEffect)((function(){""!==x&&Ze()}),[x]),(0,a.useEffect)((function(){""===x&&i.setFieldsValue(F)}),[]),(0,a.useEffect)((function(){var e,n,o,r,t,a,d,l,u,s=[{uid:null===ge||void 0===ge||null===(e=ge.imageLogo)||void 0===e?void 0:e._id,name:null===ge||void 0===ge||null===(n=ge.imageLogo)||void 0===n?void 0:n.name,status:"done",url:"".concat("https://leapmotorca.uz/api","/").concat(null===ge||void 0===ge||null===(o=ge.imageLogo)||void 0===o?void 0:o.path)}],c=[{uid:null===ge||void 0===ge||null===(r=ge.imageBrand)||void 0===r?void 0:r._id,name:null===ge||void 0===ge||null===(t=ge.imageBrand)||void 0===t?void 0:t.name,status:"done",url:"".concat("https://leapmotorca.uz/api","/").concat(null===ge||void 0===ge||null===(a=ge.imageBrand)||void 0===a?void 0:a.path)}],v=[{uid:null===ge||void 0===ge||null===(d=ge.videoBanner)||void 0===d?void 0:d._id,name:null===ge||void 0===ge||null===(l=ge.videoBanner)||void 0===l?void 0:l.name,status:"done",url:"".concat("https://leapmotorca.uz/api","/").concat(null===ge||void 0===ge||null===(u=ge.videoBanner)||void 0===u?void 0:u.path)}];if(be){var f={mediaLogoId:s,mediaBrandId:c,mediaVideoId:v};L(s),D(c),B(v),i.setFieldsValue(f)}}),[ge]),(0,a.useEffect)((function(){var e,i,n,o,r,t,a,d,l,u,s,c,v,f,m,p,g,Z,b,h,j,F="",O="",w="";if(be&&fe&&null!==(e=S[0])&&void 0!==e&&null!==(i=e.originFileObj)&&void 0!==i&&i.uid)F=null===(a=ce[0])||void 0===a?void 0:a._id;else if(be){var I;F=null===(I=S[0])||void 0===I?void 0:I.uid}if(be&&fe&&null!==(n=P[0])&&void 0!==n&&null!==(o=n.originFileObj)&&void 0!==o&&o.uid)O=null===(d=k[0])||void 0===d||null===(l=d.originFileObj)||void 0===l||!l.uid||null!==(u=S[0])&&void 0!==u&&null!==(s=u.originFileObj)&&void 0!==s&&s.uid?3===ce.length?null===(c=ce[1])||void 0===c?void 0:c._id:2===ce.length?null===(v=ce[1])||void 0===v?void 0:v._id:null===(f=ce[0])||void 0===f?void 0:f._id:null===(m=ce[0])||void 0===m?void 0:m._id;else if(be){var L;O=null===(L=P[0])||void 0===L?void 0:L.uid}if(be&&fe&&null!==(r=k[0])&&void 0!==r&&null!==(t=r.originFileObj)&&void 0!==t&&t.uid)w=3===ce.length?null===(p=ce[2])||void 0===p?void 0:p._id:2===ce.length?null===(g=ce[1])||void 0===g?void 0:g._id:null===(Z=ce[0])||void 0===Z?void 0:Z._id;else if(be){var y;w=null===(y=k[0])||void 0===y?void 0:y.uid}!be&&ce&&(F=null===(b=ce[0])||void 0===b?void 0:b._id,O=null===(h=ce[1])||void 0===h?void 0:h._id,w=null===(j=ce[2])||void 0===j?void 0:j._id);var E={mediaLogoId:F,mediaBrandId:O,mediaVideoId:w};fe&&!be?oe({url:"/banner",data:E}):(q||fe)&&je({url:"/banner",data:E,id:x})}),[ce,R]);(0,a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],i.setFieldsValue(e));var n=function(){localStorage.setItem("myFormValues",JSON.stringify(i.getFieldsValue()))};return window.addEventListener("beforeunload",n),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",n)}}),[]);var Le=function(){var e=(0,r.Z)((0,o.Z)().mark((function e(i){var n,r,t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.url){e.next=5;break}return e.next=4,new Promise((function(e){var n=new FileReader;n.readAsDataURL(i.originFileObj),n.onload=function(){return e(n.result)}}));case 4:n=e.sent;case 5:(r=new Image).src=n,null===(t=window.open(n))||void 0===t||t.document.write(r.outerHTML);case 9:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}();return(0,j.jsx)("div",{children:ve||te||pe||Fe?(0,j.jsx)(g.QP,{}):(0,j.jsxs)(d.Z,{form:i,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:F,onFinish:function(e){var i,n,o,r,t,a,d,l,u,s,c,v,f,m,p,g,Z,b,h,j,F,x,O,w,I,L,y,E,D,V,_=new FormData,B=!1;if(be)if(null!==(i=S[0])&&void 0!==i&&null!==(n=i.originFileObj)&&void 0!==n&&n.uid&&null!==(o=P[0])&&void 0!==o&&null!==(r=o.originFileObj)&&void 0!==r&&r.uid&&null!==(t=k[0])&&void 0!==t&&null!==(a=t.originFileObj)&&void 0!==a&&a.uid)B=!0,_.append("media",null===(I=S[0])||void 0===I?void 0:I.originFileObj),_.append("media",null===(L=P[0])||void 0===L?void 0:L.originFileObj),_.append("media",null===(y=k[0])||void 0===y?void 0:y.originFileObj),J(!1);else if(null!==(d=S[0])&&void 0!==d&&null!==(l=d.originFileObj)&&void 0!==l&&l.uid&&null!==(u=P[0])&&void 0!==u&&null!==(s=u.originFileObj)&&void 0!==s&&s.uid){var C,U;B=!0,_.append("media",null===(C=S[0])||void 0===C?void 0:C.originFileObj),_.append("media",null===(U=P[0])||void 0===U?void 0:U.originFileObj),J(!1)}else if(null!==(c=S[0])&&void 0!==c&&null!==(v=c.originFileObj)&&void 0!==v&&v.uid&&null!==(f=k[0])&&void 0!==f&&null!==(m=f.originFileObj)&&void 0!==m&&m.uid){var R,M;B=!0,_.append("media",null===(R=S[0])||void 0===R?void 0:R.originFileObj),_.append("media",null===(M=k[0])||void 0===M?void 0:M.originFileObj),J(!1)}else if(null!==(p=P[0])&&void 0!==p&&null!==(g=p.originFileObj)&&void 0!==g&&g.uid&&null!==(Z=k[0])&&void 0!==Z&&null!==(b=Z.originFileObj)&&void 0!==b&&b.uid){var T,q;B=!0,_.append("media",null===(T=P[0])||void 0===T?void 0:T.originFileObj),_.append("media",null===(q=k[0])||void 0===q?void 0:q.originFileObj),J(!1)}else if(null!==(h=S[0])&&void 0!==h&&null!==(j=h.originFileObj)&&void 0!==j&&j.uid){var G;B=!0,_.append("media",null===(G=S[0])||void 0===G?void 0:G.originFileObj),J(!1)}else if(null!==(F=P[0])&&void 0!==F&&null!==(x=F.originFileObj)&&void 0!==x&&x.uid){var N;B=!0,_.append("media",null===(N=P[0])||void 0===N?void 0:N.originFileObj),J(!1)}else if(null!==(O=k[0])&&void 0!==O&&null!==(w=O.originFileObj)&&void 0!==w&&w.uid){var A;B=!0,_.append("media",null===(A=k[0])||void 0===A?void 0:A.originFileObj),J(!1)}else B=!1,J(!0);else B=!0,_.append("media",null===(E=S[0])||void 0===E?void 0:E.originFileObj),_.append("media",null===(D=P[0])||void 0===D?void 0:D.originFileObj),_.append("media",null===(V=k[0])||void 0===V?void 0:V.originFileObj);B&&!fe&&se({url:"/medias",formData:_}),z(e)},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(s.Z,{span:12,children:(0,j.jsx)(d.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f\u0430",name:"mediaLogoId",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u043e\u0442\u0438\u043f\u0430"}],children:(0,j.jsx)(f.Z,{rotationSlider:!0,children:(0,j.jsx)(c.Z,{maxCount:1,fileList:S,listType:"picture-card",onChange:function(e){var n=e.fileList;L(n),i.setFieldsValue({mediaLogoId:n})},onPreview:Le,beforeUpload:function(){return!1},onRemove:function(e){be&&Q(e)},children:S.length>0?"":"Upload"})})})}),(0,j.jsx)(s.Z,{span:12,children:(0,j.jsx)(d.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430",name:"mediaBrandId",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,j.jsx)(f.Z,{rotationSlider:!0,children:(0,j.jsx)(c.Z,{maxCount:1,fileList:P,listType:"picture-card",onChange:function(e){var n=e.fileList;D(n),i.setFieldsValue({mediaBrandId:n})},onPreview:Le,beforeUpload:function(){return!1},onRemove:function(e){be&&X(e)},children:P.length>0?"":"Upload"})})})})]}),(0,j.jsx)(u.Z,{gutter:20,children:(0,j.jsx)(s.Z,{span:24,children:(0,j.jsx)(d.Z.Item,{label:"\u0411\u0430\u043d\u043d\u0435\u0440\u043d\u043e\u0435 \u0432\u0438\u0434\u0435\u043e",name:"mediaVideoId",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0432\u0438\u0434\u0435\u043e\u0431\u0430\u043d\u043d\u0435\u0440"}],children:(0,j.jsx)(c.Z,{maxCount:1,accept:"video/*",fileList:k,listType:"picture-card",onChange:function(e){var n=e.fileList;B(n),i.setFieldsValue({mediaVideoId:n})},onPreview:Le,beforeUpload:function(){return!1},onRemove:function(e){be&&ie(e)},children:k.length>0?"":"Upload"})})})}),(0,j.jsx)(v.Z,{type:"primary",htmlType:"submit",style:{width:"100%"},children:be?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=243.4d248ec8.chunk.js.map