"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[325],{68438:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(74165),a=n(15861),s=n(74569),i=n.n(s);i().defaults.baseURL="".concat("https://leapmotorca.uz/api"),i().interceptors.request.use((function(e){var t=function(e){try{return localStorage.getItem(e)}catch(t){console.log("Error getting data")}}("lptoken"),n=null!==t?"Bearer ".concat(t):"";return e.headers.authorization=n,e}));var u=i(),o={getData:function(e){return(0,a.Z)((0,r.Z)().mark((function t(){var n,a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get(e);case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))()},getDataByID:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){var a,s;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.get("".concat(e,"/").concat(t));case 2:return a=n.sent,s=a.data,n.abrupt("return",s);case 5:case"end":return n.stop()}}),n)})))()},postData:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){var a,s;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.post(e,t);case 2:return a=n.sent,s=a.data,n.abrupt("return",s);case 5:case"end":return n.stop()}}),n)})))()},editData:function(e,t,n){return(0,a.Z)((0,r.Z)().mark((function a(){var s,i;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.put("".concat(e,"/").concat(n),t);case 2:return s=r.sent,i=s.data,r.abrupt("return",i);case 5:case"end":return r.stop()}}),a)})))()},deleteData:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.delete("".concat(e,"/").concat(t));case 2:case"end":return n.stop()}}),n)})))()},deleteImages:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("delete image",t),n.next=3,u.delete(e,{ids:["64f0ffa5883c58f0433c44d9"]});case 3:case"end":return n.stop()}}),n)})))()}}},325:function(e,t,n){n.r(t);var r=n(1413),a=n(29439),s=n(72791),i=n(2409),u=n(50419),o=n(66106),c=n(30914),l=n(49389),d=n(87309),m=n(91933),f=n(68438),p=n(32179),g=n(57689),Z=n(16030),h=n(77221),x=n(7993),j=n(80184),v={nameRu:"",nameUz:"",addressRu:"",addressUz:"",workingTime:"",tel:"",lat:""};t.default=function(){var e=(0,x.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}).isLoaded,t=i.Z.useForm(),n=(0,a.Z)(t,1)[0],b=(0,g.s0)(),w=(0,Z.v9)((function(e){return e.editData})).editId,y=(0,Z.I0)(),k=(0,s.useState)({lat:null,lng:null}),I=(0,a.Z)(k,2),z=I[0],R=I[1];console.log(z);var F=(0,m.useMutation)((function(e){var t=e.url,n=e.data;return f.Z.postData(t,n)}),{onSuccess:function(){u.ZP.success("Success")},onError:function(e){u.ZP.error(e)}}),S=F.mutate,E=F.data,D=F.isLoading,U=F.isSuccess,L=F.error,C=F.isError,q=(0,m.useQuery)(["edit-map",w],(function(){return f.Z.getDataByID("/map",w)}),{enabled:!1}),V=q.isLoading,T=q.data,P=q.refetch,B=q.isSuccess,M=q.error,N=q.isError,J=(0,m.useMutation)((function(e){var t=e.url,n=e.data,r=e.id;return f.Z.editData(t,n,r)})),O=J.mutate,A=J.isLoading,G=J.data,K=J.isSuccess;(0,s.useEffect)((function(){K&&y({type:h.Pb,payload:""}),(U||K)&&b("/map")}),[E,G]),(0,s.useEffect)((function(){C&&u.ZP.error(L.message),N&&u.ZP.error(M.message)}),[L,M]),(0,s.useEffect)((function(){""!==w&&P()}),[w]),(0,s.useEffect)((function(){""===w&&n.setFieldsValue(v)}),[]),(0,s.useEffect)((function(){if(B){var e={nameRu:T.nameRu,nameUz:T.nameRu,addressRu:T.addressRu,addressUz:T.addressUz,workingTime:T.workingTime,tel:T.tel,lat:T.lat};R({lat:Number(T.lat),lng:Number(T.lng)}),n.setFieldsValue(e)}}),[T]);(0,s.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],n.setFieldsValue(e));var t=function(){localStorage.setItem("myFormValues",JSON.stringify(n.getFieldsValue()))};return window.addEventListener("beforeunload",t),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return console.log(z),(0,j.jsx)("div",{children:D||V||A?(0,j.jsx)(p.QP,{}):(0,j.jsxs)(i.Z,{form:n,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:v,onFinish:function(e){console.log(e);var t=(0,r.Z)((0,r.Z)({},e),{},{lat:"".concat(z.lat),lng:"".concat(z.lng)});T?O({url:"/map",data:t,id:w}):S({url:"/map",data:t})},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,j.jsxs)(o.Z,{gutter:20,children:[(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u0438\u0430\u043b\u0430 Ru",name:"nameRu",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0444\u0438\u043b\u0438\u0430\u043b\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d Ru!"}],children:(0,j.jsx)(l.Z,{})})}),(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"Filial nomi Uz",name:"nameUz",rules:[{required:!0,message:"Filial nomini kiritish majburiy Uz!"}],children:(0,j.jsx)(l.Z,{})})})]}),(0,j.jsxs)(o.Z,{gutter:20,children:[(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"\u0410\u0434\u0440\u0435\u0441 Ru",name:"addressRu",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0430\u0434\u0440\u0435\u0441 Ru!"}],children:(0,j.jsx)(l.Z,{})})}),(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"Manzil Uz",name:"addressUz",rules:[{required:!0,message:"Manzilni kiritish shart Uz!"}],children:(0,j.jsx)(l.Z,{})})})]}),(0,j.jsxs)(o.Z,{gutter:20,children:[(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f",name:"workingTime",rules:[{required:!0,message:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0447\u0430\u0441\u044b \u0440\u0430\u0431\u043e\u0442\u044b"}],children:(0,j.jsx)(l.Z,{})})}),(0,j.jsx)(c.Z,{span:12,children:(0,j.jsx)(i.Z.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",name:"tel",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430!"}],children:(0,j.jsx)(l.Z,{})})})]}),(0,j.jsx)(o.Z,{gutter:20,children:(0,j.jsxs)(c.Z,{span:24,children:[e&&(0,j.jsx)(x.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:{lat:41.311785,lng:69.279696},onClick:function(e){var t={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};R(t),n.setFieldsValue({lat:t.lat}),console.log("Clicked LatLng:",t)},children:(0,j.jsx)(x.jC,{position:z})}),(0,j.jsx)(i.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,j.jsx)(d.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:B?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.4c2fa020.chunk.js.map